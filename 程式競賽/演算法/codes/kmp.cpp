#include<bits/stdc++.h>
using namespace std;
void build_fail_function(string B, int *fail) {
	int len = B.length(), pos;
	pos = fail[0] = -1;
	for (int i = 1; i < len; i ++) {
		while (pos != -1 and B[pos + 1] != B[i])
			pos = fail[pos];
		if (B[pos + 1] == B[i]) pos ++;
		fail[i] = pos;
	}
}
void match(string A, string B, int *fail) {
	int lenA = A.length(), lenB = B.length();
	int pos = -1;
	for (int i = 0; i < lenA; i ++) {
		while (pos != -1 and B[pos + 1] != A[i])
			pos = fail[pos];
		if (B[pos + 1] == A[i]) pos ++;
		if (pos == lenB - 1) {
			// Match ! A[i - lenB + 1, i] = B
			pos = fail[pos];
		}
	}
}
